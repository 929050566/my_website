# 密码学的发展简史
## 古典密码学
### 中国藏头诗
芦花丛中一扁舟，
俊杰俄从此地游。 　　
义士若能知此理，
反躬难逃可无忧。
- 表达的意义：芦俊义反
我画蓝江水悠悠，
爱晚亭上枫叶愁。
秋月溶溶照佛寺，
香烟袅袅绕经楼。
- 表达的意义：我爱秋香

### 滚桶密码
- 滚筒的尺寸来设计，只有尺寸大小一摸一样的滚筒才能解密文字
![alt text](wallet/image-8.png)
### 掩格密码
16世纪米兰的物理学和数学家Cardano发明的掩格密码，可以事先设计好方格的开孔，将所要传递的信息和一些其他无关的符号组合成无效的信息，使截获者难以分析出有效信息。

### 棋盘密码
我们可以建立一张表，使每一个字符对应一数 ， 是该字符所在行标号， 是列标号。这样将明文变成形式为一串数字密文。

### 掩格密码
16世纪米兰的物理学和数学家Cardano发明的掩格密码，可以事先设计好方格的开孔，将所要传递的信息和一些其他无关的符号组合成无效的信息，使截获者难以分析出有效信息。

### 凯撒（Caesar）密码
在罗马帝国时期，凯撒大帝曾经设计过一种简单的移位密码，用于战时通信。这种加密方法就是将明文的字母按照字母顺序，往后依次递推相同的字母，就可以得到加密的密文，而解密的过程正好和加密的过程相反。
原理：把一个字母替换为它后面固定位置的另一个字母（单表代换密码）。
A B C D E F G …… X Y Z
D E F G H I J …… A B C
明文:Caesar cipher is a shift substitution
密文:FDHVDU FLSKHU LV D VKLIW VXEVWLWXWLRQ
### 弗纳姆密码
1918年Gilbert Vernam 为AT&T设计的一种一次一密乱码本密码（多表代换密码）。
原理：使用一个任意长的不重复数字序列，把它和明文组合在一起。
明文： V E R N A M C I P H E R
等价数字：21 4 17 13 0 12 2 8 15 7 4 17
+随机数： 76 48 16 82 44 3 58 11 60 5 48 88
和mod26： 19 0 7 17 18 15 8 19 23 12 0 1
密文： t a h r s p i t x m a b
### 圆盘密码
人们对凯撒密码进一步改善，只要将字母按照不同的顺序进行移动就可以提高破解的难度，增加信息的保密程度。如15世纪佛罗伦萨人Alberti发明圆盘密码就是这种典型的利用单表置换的方法加密的方法。如图在两个同心圆盘上，内盘按不同（杂乱）的顺序填好字母或数字，而外盘按照一定顺序填好字母或数字，转动圆盘就可以找到字母的置换方法，很方便的进行信息的加密与解密。凯撒密码与圆盘密码本质都是一样的，都属于单表置换，即一个明文字母对应的密文字母是确定的，截获者可以分析对字母出现的频率，对密码体制进行有效的攻击。Alberti的圆盘理论是古典密码学的主要代表之一, 在粘土圆盘的表面刻上带有空格的字母, 成为最初人类的加密方式, 这种方式至今还无人能破戒。
### 维吉尼亚密码
为了提高密码的破译的难度，人们有发明一种多表置换的密码，即一个明文字母可以表示为多个密文字母，多表密码加密算法结果将使得对单表置换用的简单频率分析方法失效，其中维吉尼亚密码就是一种典型的加密方法。维吉尼亚密码是使用一个词组（语句）作为密钥，词组中每一个字母都作为移位替换密码密钥确定一个替换表，维吉尼亚密码循环的使用每一个替换表完成明文字母到密文字母的变换，最后所得到的密文字母序列即为加密得到的密文。维吉尼亚是古典密码理论发展上的一个重要里程碑,他的理论又被称为多字母编码。
m个移位代换表由m个字母组成的密钥字确定
明文：w e a r d i s c o v e r e d s a v e
密钥：d e c e p t i v e d e c e p t i v e
对应数字：3 4 2 15 19 8 21
密文：Z I C V T WQNGRZGVTWAVZH
### 换位密码（置换密码）
1.换位就是将明文中的字母的位置重排。最简单的换位就是逆序法：
明文：computer system
密文：metsys retupmoc
2.列置换（纵行换位）：把明文中的字符按列重新排列。 例如： 明文：THIS IS A MESSAGE.
T   H    I    S    I
      S   A    M    E    S
      S   A    G    E    X
密文：TSSHAAIMGSEEISX
3.引入密钥k
如k=COMPUTER，明文为：WHAT CAN YOU LEARN FROM THIS BOOK
![alt text](wallet/image-9.png)
密文为：WORO NNSX ALMK HUOO TETX YFBX ARIX CAHX
1.9.Enigma转轮组的加密
Enigma转轮组的加密原理，正是多表替代——它通过不断改变明文和密文的字母映射关系，对明文字母们进行着连续不断的换表加密操作。
![alt text](wallet/image-10.png)
- 三个转子不同的方向组成了262626=17576种不同可能性；
- 三个转子间不同的相对位置为6种可能性；
- 连接板上两两交换6对字母的可能性数目非常巨大，有100391791500种；于是一共有175766100391791500，大约为10000000000000000，即一亿亿种可能性。
当时一台Enigma转轮组的加密 24万 人民币。
20世纪30年代领导波兰密码学家率先对德国使用的Enigma密码进行了系统性的研究和破译。在破译过程中，雷耶夫斯基首次将严格的数学化方法应用到密码破译领域，这在密码学的历史上是一个重要成就。雷耶夫斯基等人在二战期间破译了大量来自德国的信息，他们的工作成为整个二战期间盟国破译德军Enigma密码的基础。雷耶夫斯基与波兰数学家杰尔兹·罗佐基和亨里克·佐加尔斯基并称为密码研究领域的“波兰三杰”。

# 近代密码学

密码形成一门新的学科是在20世纪70年代，这是受计算机科学蓬勃发展刺激和推动的结果。快速电子计算机和现代数学方法一方面为加密技术提供了新的概念和工具，另一方面也给破译者提供了有力武器。计算机和电子学时代的到来给密码设计者带来了前所未有的自由，他们可以轻易地摆脱原先用铅笔和纸进行手工设计时易犯的错误，也不用再面对用电子机械方式实现的密码机的高额费用。

Arthur Scherbius于1919年设计出了历史上最著名的密码机—德国的Enigma机,，在二次世界大战期间， Enigma曾作为德国陆、海、空三军最高级密码机。Enigma机使用了3个正规轮和1个反射轮。这使得英军从1942年2月到12月都没能解读出德国潜艇发出的信号。转轮密码机的使用大大提高了密码加密速度，但由于密钥量有限，到二战中后期时，引出了一场关于加密与破译的对抗。首先是波兰人利用德军电报中前几个字母的重复出现，破解了早期的Enigma密码机，而后又将破译的方法告诉了法国人和英国人。英国人在计算机理论之父——图灵的带领下，通过寻找德国人在密钥选择上的失误，并成功夺取德军的部分密码本，获得密钥，以及进行选择明文攻击等等手段，破解出相当多非常重要的德军情报。

这一阶段真正开始源于香农在20世纪40年代末发表的一系列论文，特别是1949年的《保密系统通信理论》，把已有数千年历史的密码学推向了基于信息论的科学轨道。近 代密码发展中一个重要突破是“数据加密标准”（DES）的出现。DES 密码的意义在于，首先，其出现使密码学得以从政府走向民间，其设计主要由IBM公司完成，国家安全局等政府部门只是参与其中，最终经美国国家标准局公开征集遴选后，确定为联邦信息处理标准。其次，DES密码设计中的很多思想（Feistel结构、S盒等），被后来大多数分组密码所采用。再次，DES 出现之后，不仅在美国联邦部门中使用，而且风行世界，并在金融等商业领域广泛使用。

DES: 近代密码学的形成
- 单密钥加密
  - 只有一把密码
  - 加密解密都是使用这把密钥

# 现代密码学
1976 年，美国密码学家提出“公钥密码”概念。此类密码中加密和解密使用不同的密钥，其中，用于加密的叫做公钥，用于解密的为私钥。1977年，美国麻省理工学院提出第一个公钥加密算法RSA算法，之后ElGamal、椭圆曲线、双线性对等公钥密码相继被提出，密码学真正进入了一个新的发展时期。一般来说，公钥密码的安全性由相应数学问题在计算机上的难解性来保证，以广为使用的RSA算法为例，它的安全性是建立在大整数素因子分解在计算机上的困难性，如，对于整数22，我们易于发现它可以分解为2和11两个素数相乘，但对于一个500位的整数，即使采用相应算法，也要很长时间才能完成分解。但随着计算能力的不断增强和因子分解算法的不断改进，

## RSA 算法出现
RSA 算法出现标志着现代密码学走向成熟
- 公钥密码：双密钥，一般公钥，一把是私钥，公钥匙一般是公开的，私钥是持有私有的
  - 加解密
    - 公钥用于加密
    - 私钥用于解密
  - 签名验签
    - 私钥签名
    - 公钥验证签名

## 量子密码学
特别是量子计算机的发展，公钥密码安全性也渐渐受到威胁， 抗量子计算密码学研究也很火热
目前，研究者们开始关注量子密码、格密码等抗量子算法的密码，后量子密码等前沿密码技术逐步成为研究热点。
但是目前是不成熟的，逐步走向成熟中。

## 单向散列函数
单向散列函数(杂凑散列函数，Hash 函数)：给定一个输入 X，得到 H(X), 只能有 X 得到 H(X), 不能通过 H(X) 反推 X。
- Hash 碰撞：给定一个 X，得到 H(X), 给定一个 Y 也能得到 H(X), 碰撞的可能性极低，在现有计算机体系，即使地球爆炸，也很难发生碰撞
- Hash 算法攻击：穷举，不断找 X，直到得得 H(X') =  H(X)
- 特点
  - 单向不可逆性
  - 进行防篡改
  - Hash 碰撞
- 攻击方式：穷举
- Hash 算法：
  - MD4和 MD5: 已经被破解
  - Sha-0 和 Sha-1: 已经被破解
  - 破解的事件
    - 2004年8月17日，在CRYPTO 2004的Rump会议上，王小云，冯登国、来学嘉，和于红波宣布了攻击MD5、SHA-0 和其他杂凑函数的初步结果。他们攻击SHA-0的计算复杂度是2的40次方，这意味着他们的攻击成果比Joux还有其他人所做的更好。请参见MD5 安全性。2005年二月，王小云和殷益群、于红波再度发表了对SHA-0破密的算法，可在2的39次方的计算复杂度内就找到碰撞。
    - 2005年二月，王小云、殷益群及于红波发表了对完整版 SHA-1 的攻击，只需少于 2 的 69 次方的计算复杂度，就能找到一组碰撞。（利用生日攻击法找到碰撞需要 2 的 80 次方的计算复杂度。）
  - SHA-2：目前还是安全的
    - SHA-256 算法
    - SHA3-384：384位输出长度
    - SHA3-512：512位输出长度
  - Keccak 海绵算法：目前是安全
  - Blake 和 Blake2：目前是安全
  - Poseidon 算法：应用在 ZK 承诺里面，安全级别很高，目前是没有被破解
- Hash 算法的应用场景
  - 做为数字信封，防止被篡改
  - 生成数字摘要，用于辅助数字签名
## 对称加密
- 单密钥加密
  - 只有一把密码
  - 加密解密都是使用这把密钥
- 代表算法
  - DES：已经被破解，不安全
  - 3DES：安全的，复杂度很高，算法效率
  - AES:  相对于 3DES 复杂度低很多，效率要高很多，还是安全的
## 非对称加密(公钥密码学)
- 公钥密码：双密钥，一般公钥，一把是私钥，公钥匙一般是公开的，私钥是持有私有的
  - 加解密
    - 公钥用于加密
    - 私钥用于解密
  - 签名验签
    - 私钥签名
    - 公钥验证签名
- 代表算法
  - RSA 算法流程
```go
密钥生成
选择两个大素数: 选择两个大素数 p 和 𝑞。
计算模数 𝑛
𝑛=𝑝×𝑞 
计算欧拉函数 𝜙(𝑛)
𝜙(𝑛)=(𝑝−1)×(𝑞−1)
选择公钥指数 𝑒
选择一个整数 𝑒 满足 1<𝑒<𝜙(𝑛)  且 𝑒与 𝜙(𝑛) 互质。
计算私钥指数 𝑑
计算 𝑑使得 𝑑×𝑒≡1 mod  𝜙(𝑛)，即 𝑑 是 𝑒 在模 𝜙(𝑛) 下的乘法逆元。
公钥和私钥
公钥：(𝑒,𝑛)
私钥：(𝑑,𝑛)
加密过程
假设明文为 𝑀，加密得到密文 𝐶 的过程如下：
解密过程
假设密文为 𝐶，解密得到明文 𝑀 的过程如下：
签名和验证
数字签名: 用私钥对消息 𝑀 进行签名，得到签名 𝑆：
验证签名: 用公钥验证签名 𝑆，验证得到消息 𝑀′：
如果 𝑀′=𝑀，则签名验证通过。
```
  - 椭圆曲线算法 ECC，ECDSA 和 EDDSA 
    - ECDSA：安全性依赖椭圆曲线的离散对数问题
      - secp256k1  256bit  比特币，以太坊
      - secp256r1  256bit   EOS 用到了
      - secp384r1 
      - secp512r1 
    - EDDSA：EdWards 曲线
      - ed25519   256bit  Solana, Ton 
      - ed448      448bit   更高的安全需求
    - ECDSA Vs EDDSA 对比
      - 曲线上：ECDSA weierstrass 曲线，EDDSA EdWards 曲线
      - ECDSA 依赖随机数;  EDDSA不依赖随机数, 通过 H(d)
      - ECDSA 更容易被攻击，EDDSA 更安全
      - 签名速度：ECDSA 慢，EDDSA 快
      - 验证签名：ECDSA 慢，EDDSA 快
      - 举例子
        - ECDSA：BTC， ETH
        - EdDSA：Solana, Sui, Aptos, Ton
        
## 门限共享秘密
门限共享秘密，秘密的备份和恢复，在密钥托管项目里面应用是比较广泛的
1. 直接用门限共享秘密算法
![alt text](wallet/image-11.png)
1. 云端可干扰抗秘密丢失解决方案
![alt text](wallet/image-12.png)
## MPC 算法
安全多方计算：多方参与，进行多轮交互计算出各自密钥分片，参与方之间互相是不知道对方持有密钥分片，所有节点持有密钥分片可以组成一把完整私钥，MPC 也是一种门限签名。
全网有 n(n=10) 个节点，每个节点持有一个密钥分片，设置 k (k=7) 节点签名交易有效，也就 7 节点签名一笔就可以有效，节点签完名之后，将这些签名聚合器，就可以得到完整的签名。

- 任意 7 份密钥泄露，拿到这  7 份密钥分片的人是可以恢复出完整的私钥。
暂时无法在Lark文档外展示此内容
# 总结
- 对称加密使用那个算法最优
- Hash 的安全性
- 非对称加密算法
  - ECDSA 和 EdDSA 的区别与联系
- 门限共享秘密算法
- MPC